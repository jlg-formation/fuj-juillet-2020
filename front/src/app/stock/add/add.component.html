<main>
  <h1>Ajouter un article</h1>
  <form [formGroup]="f" (ngSubmit)="submit()">
    <label>
      <div>Nom</div>
      <input type="text" appAutofocus formControlName="name" />
      <ng-container
        [ngTemplateOutlet]="errorMsg"
        [ngTemplateOutletContext]="{ errors: f.controls['name'].errors }"
      ></ng-container>
    </label>
    <label>
      <div>Prix</div>
      <input type="number" step="0.01" min="0" formControlName="price" />
      <ng-container
        [ngTemplateOutlet]="errorMsg"
        [ngTemplateOutletContext]="{ errors: f.controls['price'].errors }"
      ></ng-container>
    </label>
    <label>
      <div>Quantité</div>
      <input type="number" step="1" min="1" formControlName="qty" />
      <ng-container
        [ngTemplateOutlet]="errorMsg"
        [ngTemplateOutletContext]="{ errors: f.controls['qty'].errors }"
      ></ng-container>
    </label>
    <button class="primary" [disabled]="f.invalid">
      <fa-icon
        [icon]="isAdding ? faCircleNotch : faPlus"
        [spin]="isAdding"
      ></fa-icon>
      Ajouter
    </button>
  </form>
  {{ f.controls["name"].errors | json }}
</main>

<ng-template #errorMsg let-errors="errors">
  <div class="error">
    <ng-container *ngIf="errors">
      <div *ngIf="errors.required">Le champ est requis</div>
      <div *ngIf="errors.maxlength">
        Le champ est trop long (12 > 10 caractères max).
      </div>
      <div *ngIf="errors.minlength">
        Le champ est trop petit (3 caractères min).
      </div>
    </ng-container>
  </div>
</ng-template>
